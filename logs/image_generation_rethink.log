2025-06-15 09:33:14 [INFO] image_generation_rethink: /image model only: 76.958 sec
2025-06-15 09:41:40 [INFO] image_generation_rethink: {'prompt_1': 'In a vibrant Nairobi street, a diverse group of young adults (ages 25-40) stands confidently in stylish attire, showcasing their unique fashion choices and laughing together. In the background, iconic Nairobi architecture creates a dynamic urban scene. One model holds the USHINDI BAR prominently but naturally amid the group, illustrating its role as a trendy choice in daily life. Bright colors and engaging facial expressions invite onlookers to connect with the aspirational vibe of effortless style and community.', 'prompt_2': 'A serene laundry scene on a sunny rooftop in Nairobi, where young adults are socializing while hanging freshly washed clothes. The USHINDI BAR is subtly integrated into a beautifully arranged laundry basket made of traditional materials, reflecting local craftsmanship. Bursts of color from the clothes allude to cultural patterns and fabrics, while laughter and conversation flow in the air, symbolizing the lifestyle of trendsetters embracing modernity with a nod to tradition.', 'prompt_3': 'An artistic close-up of a group of friends in a cozy, inviting living space adorned with local art. One person smiles as they wash clothes with USHINDI BAR, highlighting its effortless use. Surrounding them are elements of Nairobi culture—bright textiles, local crafts, and modern decor—merging tradition with contemporary life. The scene emanates a warm, friendly atmosphere, demonstrating that the USHINDI BAR laundry bar is a staple in the urban lifestyle of trendsetters.'}
2025-06-15 09:42:53 [INFO] image_generation_rethink: /image model only: 73.506 sec
2025-06-15 09:47:27 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist creating culturally resonant visual prompts.\nOBJECTIVE: Help generate creative image prompts for marketing campaigns.\nTONE: Your output must be simple, visual, emotionally appealing, and aligned with platform-specific trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN DATA:\n- Product: USHINDI BAR, Category: LAUNDRY BAR, SKU: None\n- Product_details: [{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n- Platform: Facebook, Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads, Category: Engagement\n- Tone: Aspirational\n- Region: NAIROBI - NAIROBI, THIKA\n- Target Audience:\n    - Age Range: 25-40\n    - Gender: All Genders\n    - Income Level: Middle to High\n    - Urban/Rural: Urban\n\nPROMPT INSTRUCTIONS:\nCreate visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically\n\n\n\n\nREQUIREMENTS:\n- The product image must **not be altered** should be mentoined in the prompt you generate.\n- The image must be culturally relevant and optimized for **Facebook** trends.\n- Keep the prompt **visually imaginative** but **not overly detailed** to avoid confusing the image generation model.\n- Make sure that prompt instructions is followed This is important also The image should associate with the product and it should make sense.\n', additional_kwargs={}, response_metadata={})]
2025-06-15 09:47:34 [INFO] image_generation_rethink: {'prompt_1': 'A vibrant street scene in Nairobi, showcasing a diverse group of stylish young adults (aged 25-40) engaged in a playful laundry day. The backdrop features iconic Nairobi architecture like the Kenyatta International Conference Centre, colorful street art, and local fashion. In the foreground, a fashionable individual holds the USHINDI BAR prominently with a bright smile, while others cheerfully hang up colorful clothes. The scene is infused with lively colors that reflect the energy of urban life, embodying the Trendsetter Movement while subtly incorporating the product without alteration.', 'prompt_2': 'A chic and modern living space in Nairobi, where a group of friends (aged 25-40) are gathered for a cozy evening. They are playfully folding laundry, with the USHINDI BAR smartly placed on the coffee table. Elements of local culture, such as Kanga fabric draped over the couch and traditional Makonde carvings, enhance the African essence of the scene. The lighting is warm and inviting, promoting a sense of community and aspiration while positioning the product naturally within a relatable, everyday moment.', 'prompt_3': "An energetic outdoor market scene in Thika, filled with local shoppers and vibrant stalls. Focused on a stylish individual (aged 25-40) showcasing their colorful laundry, using the USHINDI BAR as a style statement rather than just a product. The surrounding market buzz reflects Nairobi's dynamic lifestyle, while traditional fruits and crafts add local flavor. Bright, eye-catching colors and fun interactions embody the aspirational spirit, encapsulating the essence of the Trendsetter Movement without altering the product placement."}
2025-06-15 09:49:06 [INFO] image_generation_rethink: /image model only: 91.759 sec
2025-06-16 07:07:52 [ERROR] image_generation_rethink: Image generation failed: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 35, in image_llm_new
    async with aiofiles.open(image_path, "rb") as f:
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 63, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/threadpool/__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
2025-06-16 07:08:41 [ERROR] image_generation_rethink: Image generation failed: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 35, in image_llm_new
    async with aiofiles.open(image_path, "rb") as f:
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 63, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/threadpool/__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
2025-06-16 07:10:55 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist creating culturally resonant visual prompts.\nOBJECTIVE: Help generate creative image prompts for marketing campaigns.\nTONE: Your output must be simple, visual, emotionally appealing, and aligned with platform-specific trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN DATA:\n- Product: USHINDI BAR, Category: LAUNDRY BAR, SKU: None\n- Product_details: [{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n- Platform: Facebook, Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads, Category: Engagement\n- Tone: Aspirational\n- Region: NAIROBI - NAIROBI, THIKA\n- Target Audience:\n    - Age Range: 25-40\n    - Gender: All Genders\n    - Income Level: Middle to High\n    - Urban/Rural: Urban\n\nPROMPT INSTRUCTIONS:\nCreate visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically\n\n\n\n\nREQUIREMENTS:\n- The product image must **not be altered** should be mentoined in the prompt you generate.\n- The image must be culturally relevant and optimized for **Facebook** trends.\n- Keep the prompt **visually imaginative** but **not overly detailed** to avoid confusing the image generation model.\n- Make sure that prompt instructions is followed This is important also The image should associate with the product and it should make sense.\n', additional_kwargs={}, response_metadata={})]
2025-06-16 07:11:08 [INFO] image_generation_rethink: {'prompt_1': 'A vibrant Nairobi street scene featuring a group of diverse, stylish young adults (ages 25-40) showcasing their trendsetting fashion. They are gathered around a colorful mural, incorporating local artistry and symbols, while playfully interacting with a prominently displayed USHINDI BAR laundry bar in a natural, candid manner. The urban architecture provides a dynamic backdrop with hints of green spaces, reflecting freshness and vibrancy. Colorful elements that evoke optimism and energy dominate the atmosphere, making the scene aspirational yet relatable. The product remains unaltered in its packaging, seamlessly blending into this culturally rich narrative.', 'prompt_2': 'An aspirational rooftop gathering at sunset in Nairobi where trendy young professionals (ages 25-40) share laundry tips while holding the USHINDI BAR laundry bar. The skyline of Nairobi is visible in the background, with lights beginning to twinkle. Integrating local fashion trends, laughter, and connection, the scene evokes a sense of community while emphasizing the role of early adopters as influencers in their urban lifestyle. Bright colors resonate with positivity and style, reinforcing the Trendsetter Movement without altering the product, which is naturally included in a chic layout.', 'prompt_3': 'A modern Nairobi living room filled with young adults (ages 25-40) hosting an eco-friendly laundry party. Lush indoor plants, local art pieces, and stylish furniture create a trendy space. The USHINDI BAR laundry bar is showcased on a coffee table filled with fresh flowers and colorful fabrics ready for washing. The group interacts joyfully, sharing tips on sustainable living. The scene captures a culturally authentic vibe, emphasizing optimism and trendsetting, while the product remains visibly recognizable and unaltered.'}
2025-06-16 07:12:22 [INFO] image_generation_rethink: /image model only: 74.364 sec
2025-06-16 07:13:51 [ERROR] image_generation_rethink: Image generation failed: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 35, in image_llm_new
    async with aiofiles.open(image_path, "rb") as f:
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 63, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/aiofiles/threadpool/__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'Ushindi Laundry Bar.png'
2025-06-16 11:54:15 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-16 11:54:19 [ERROR] image_generation_rethink: Image generation failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 103, in image_llm_new
    prompt= await  structured_llm.ainvoke(messages)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3089, in ainvoke
    input = await asyncio.create_task(part(), context=context)  # type: ignore
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5453, in ainvoke
    return await self.bound.ainvoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 353, in ainvoke
    llm_result = await self.agenerate_prompt(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 905, in agenerate_prompt
    return await self.agenerate(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 863, in agenerate
    raise exceptions[0]
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 1033, in _agenerate_with_cache
    result = await self._agenerate(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_openai/chat_models/base.py", line 1129, in _agenerate
    response = await self.root_async_client.beta.chat.completions.parse(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/resources/beta/chat/completions.py", line 437, in parse
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1767, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1461, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1562, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-06-18 09:30:29 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-18 09:30:33 [ERROR] image_generation_rethink: Image generation failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 103, in image_llm_new
    prompt= await  structured_llm.ainvoke(messages)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3089, in ainvoke
    input = await asyncio.create_task(part(), context=context)  # type: ignore
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5453, in ainvoke
    return await self.bound.ainvoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 353, in ainvoke
    llm_result = await self.agenerate_prompt(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 905, in agenerate_prompt
    return await self.agenerate(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 863, in agenerate
    raise exceptions[0]
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 1033, in _agenerate_with_cache
    result = await self._agenerate(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_openai/chat_models/base.py", line 1129, in _agenerate
    response = await self.root_async_client.beta.chat.completions.parse(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/resources/beta/chat/completions.py", line 437, in parse
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1767, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1461, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1562, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-06-18 09:30:47 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-18 09:30:51 [ERROR] image_generation_rethink: Image generation failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 103, in image_llm_new
    prompt= await  structured_llm.ainvoke(messages)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3089, in ainvoke
    input = await asyncio.create_task(part(), context=context)  # type: ignore
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5453, in ainvoke
    return await self.bound.ainvoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 353, in ainvoke
    llm_result = await self.agenerate_prompt(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 905, in agenerate_prompt
    return await self.agenerate(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 863, in agenerate
    raise exceptions[0]
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 1033, in _agenerate_with_cache
    result = await self._agenerate(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_openai/chat_models/base.py", line 1129, in _agenerate
    response = await self.root_async_client.beta.chat.completions.parse(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/resources/beta/chat/completions.py", line 437, in parse
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1767, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1461, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1562, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-06-18 09:31:20 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-18 09:31:24 [ERROR] image_generation_rethink: Image generation failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 103, in image_llm_new
    prompt= await  structured_llm.ainvoke(messages)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3089, in ainvoke
    input = await asyncio.create_task(part(), context=context)  # type: ignore
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5453, in ainvoke
    return await self.bound.ainvoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 353, in ainvoke
    llm_result = await self.agenerate_prompt(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 905, in agenerate_prompt
    return await self.agenerate(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 863, in agenerate
    raise exceptions[0]
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 1033, in _agenerate_with_cache
    result = await self._agenerate(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_openai/chat_models/base.py", line 1129, in _agenerate
    response = await self.root_async_client.beta.chat.completions.parse(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/resources/beta/chat/completions.py", line 437, in parse
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1767, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1461, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1562, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-06-18 09:32:44 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-18 09:32:49 [ERROR] image_generation_rethink: Image generation failed: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "/home/delin/Coding/pwani_oil/llm/image_rethink.py", line 103, in image_llm_new
    prompt= await  structured_llm.ainvoke(messages)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3089, in ainvoke
    input = await asyncio.create_task(part(), context=context)  # type: ignore
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5453, in ainvoke
    return await self.bound.ainvoke(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 353, in ainvoke
    llm_result = await self.agenerate_prompt(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 905, in agenerate_prompt
    return await self.agenerate(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 863, in agenerate
    raise exceptions[0]
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 1033, in _agenerate_with_cache
    result = await self._agenerate(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/langchain_openai/chat_models/base.py", line 1129, in _agenerate
    response = await self.root_async_client.beta.chat.completions.parse(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/resources/beta/chat/completions.py", line 437, in parse
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1767, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1461, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/delin/anaconda3/envs/AI_projects/lib/python3.12/site-packages/openai/_base_client.py", line 1562, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************5w0A. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-06-18 09:35:48 [INFO] image_generation_rethink: input_forPromptgenrerator:[SystemMessage(content='\nROLE: You are a top-tier advertising strategist specialized in crafting culturally grounded, emotionally compelling visual prompts for image generation tools.\n\nOBJECTIVE: Generate high-impact, brand-aligned image prompts that reflect authentic product usage scenarios and resonate with the target demographic. The prompts must be optimized for the visual and emotional tone of the target platform.\n\nTONE: Culturally authentic, emotionally resonant, visually clear, and aligned with digital platform trends.\n', additional_kwargs={}, response_metadata={}), HumanMessage(content='\nCAMPAIGN BRIEF:\n- Product: USHINDI BAR\n- Category: LAUNDRY BAR, SKU: None\n- Platform: Facebook | Channel: Facebook Geo-Targeting\n- Campaign Type: Social Media Ads | Category: Engagement\n- Tone: Aspirational\n\nAUDIENCE INSIGHTS:\n- Region: NAIROBI - NAIROBI, THIKA\n- Age Range: 25-40\n- Gender: All Genders\n- Income Level: Middle to High\n- Urban/Rural: Urban\n\nPRODUCT DETAILS:\n[{\'Category\': \'LAUNDRY BAR\', \'Brand\': \'USHINDI\', \'All SKUs\': \'1000G, 175G, 350G, 60G, 800G\', \'Variants\': \'Blue, Cream, Green, Lemon, White, Yellow\', \'Brand Promise\': \'None\', \'Brand Positioning\': \'None\', \'Brand Extension\': \'None\', \'Age Group\': \'25yrs - 45yrs\', \'Sex Group\': \'M/F\', \'LSM (Socioeconomic Group)\': \'None\', \'Demographics\': \'None\', \'Customer Description\': \'None\', \'Customer Pain Area\': \'None\', \'Where Do They Shop?\': \'None\', \'Purchase Pattern\': \'None\', \'Product Features and Benefits\': \'None\', \'Channel Distribution\': \'None\', \'White Space\': \'None\', \'Market Share\': \'None\', \'Price\': \'Premium\', \'Competition\': \'WHITE STAR, STAJOS INVESTMENTS\'}]\n\nTASK:\nCreate one imaginative and visually striking image prompt that adheres to the following:\n\n✅ CORE REQUIREMENTS:\n- The product must be shown in a **realistic and culturally accurate usage scenario**.\n  - E.g., laundry soap should appear in actual washing contexts: backyard wash areas, water taps, washing lines — **not in irrelevant places like living rooms or rooftops**.\n- Reflect the creative instruction: **Create visually compelling imagery for USHINDI BAR laundry bar targeting NAIROBI consumers using the "Trendsetter Movement - Position early adopters as trendsetters" creative concept.\n\nCREATIVE VISUAL DIRECTION:\n- Execute the creative concept: Trendsetter Movement - Position early adopters as trendsetters\n- Feature diverse 25-40 year old models reflecting NAIROBI demographics\n- Use dynamic, engaging compositions that break typical laundry bar advertising molds\n- Incorporate unexpected visual elements that support the creative concept\n- Include NAIROBI cultural elements (architecture, lifestyle, fashion, local symbols)\n- Create visual storytelling that supports the campaign narrative\n\nVISUAL CREATIVITY GUIDELINES:\n- Think cinematically - create scenes that tell a story in a single frame\n- Use color psychology appropriate for NAIROBI culture and the creative concept\n- Include subtle laundry bar product integration that feels natural, not forced\n- Create visual metaphors or symbols that reinforce the campaign message\n- Design for social media engagement - visually striking and shareable\n- Balance artistic creativity with brand recognition and product visibility\n\nMOOD & ATMOSPHERE:\n- Aspirational and culturally authentic\n- Emotionally resonant with the creative concept\n- Optimistic and aspirational while remaining relatable\n- Distinctly different from standard laundry bar product photography\n\nSETTING: Urban environment typical of NAIROBI, THIKA with creative interpretation\nCREATIVE EXECUTION: Make every visual element serve the "Trendsetter Movement - Position early adopters as trendsetters" concept while showcasing USHINDI BAR authentically**\n- Include **authentic emotional cues** (e.g., pride in cleanliness, joy in daily life, family care).\n- Emphasize that the **product itself must not be visually altered** — retain its original appearance.\n- Ensure the visual concept is suitable for **Facebook** trends and aesthetics.\n\n🚫 AVOID:\n- Illogical or trendy scenes disconnected from actual product use.\n- Generic backdrops (e.g., empty streets, plain rooms) that don’t support the product narrative.\n- Overly complicated or abstract imagery.\n\n🎨 VISUAL STYLE GUIDELINES:\n- Be concise and visual in your description.\n- Use culturally resonant symbols, environments, and emotions.\n- Favor clarity and storytelling over detail overload.\n- Ensure every visual element supports the product’s purpose and message.\n\nMake sure the image prompt helps users immediately understand **what the product is, how it’s used, and why it matters**, through a meaningful, emotionally resonant visual story.\n', additional_kwargs={}, response_metadata={})]
2025-06-18 09:36:05 [INFO] image_generation_rethink: {'prompt_1': "A vibrant outdoor scene in a bustling Nairobi neighborhood, showcasing a joyful family gathering around a traditional wash area, with sunlight streaming through tropical trees. A diverse group of three friends, two women and one man, aged 30-35, laugh and chat while washing clothes with the USHINDI BAR laundry bar. Their modern yet culturally inspired outfits reflect Nairobi's urban fashion trends, incorporating colorful prints. The USHINDI BAR is prominently featured, resting naturally on the edge of a basin filled with bubbly water. In the background, the iconic Nairobi skyline can be subtly seen, blending tradition with modernity, a local mural depicting community life adds character. The scene exudes joy, pride, and a sense of togetherness, embodying the aspirational nature of the 'Trendsetter Movement.'", 'prompt_2': 'An eye-catching close-up of a stylish young woman, wearing contemporary yet culturally inspired attire, standing in a stylish urban laundry setup. She holds the USHINDI BAR in one hand while playfully tossing a colorful piece of fabric into a clean, water-filled basin. The background features a vibrant wall with Nairobi street art reflecting local culture. The lighting highlights her genuine smile and the vibrancy of the product. The image is framed to suggest movement and energy, engaging viewers and emphasizing the aspirational lifestyle associated with using USHINDI BAR in urban life.', 'prompt_3': "A cinematic wide shot of a lively rooftop gathering in Nairobi at sunset, where a group of diverse friends, aged 25-40, engage in a collaborative laundry day. They use the USHINDI BAR, which is elegantly displayed in the center of their setup surrounded by freshly cleaned garments hanging on a stylish clothesline adorned with fairy lights. The Nairobi skyline glows in the background, populated with both traditional and modern architecture. The friends joyfully share moments of laughter while washing clothes, showcasing emotional cues of community and pride in cleanliness, perfectly capturing the aspirational essence of the 'Trendsetter Movement'."}
2025-06-18 09:37:21 [INFO] image_generation_rethink: /image model only: 76.517 sec
